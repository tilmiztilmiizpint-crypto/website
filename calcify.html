<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Minimalis</title>
    <link rel="stylesheet" href="calcify.css">
</head>

<body>
    <div class="background-circle"></div>

    <div class="calculator-container">
        <div class="calculator">
            <div class="display">
                <input type="text" id="display" disabled value="0">
            </div>
            <div class="buttons">
                <div class="row">
                    <button class="operator" onclick="clearDisplay()">C</button>
                    <button class="operator" onclick="setOperator('+')">+</button>
                    <button class="operator" onclick="setOperator('-')">-</button>
                    <button class="operator" onclick="setOperator('*')">×</button>
                    <button class="operator" onclick="setOperator('/')">÷</button>
                </div>
                <div class="row">
                    <button onclick="appendNumber('7')">7</button>
                    <button onclick="appendNumber('8')">8</button>
                    <button onclick="appendNumber('9')">9</button>
                </div>
                <div class="row">
                    <button onclick="appendNumber('4')">4</button>
                    <button onclick="appendNumber('5')">5</button>
                    <button onclick="appendNumber('6')">6</button>
                </div>
                <div class="row">
                    <button onclick="appendNumber('1')">1</button>
                    <button onclick="appendNumber('2')">2</button>
                    <button onclick="appendNumber('3')">3</button>
                </div>
                <div class="row">
                    <button onclick="appendNumber('0')" class="zero">0</button>
                    <button class="equals" onclick="calculateResult()">=</button>
                </div>
            </div>
        </div>
    </div>

    <script src="calcify.js"></script>
</body>

<script>
    let currentNumber = ''; // Angka yang sedang diinput atau hasil perhitungan terakhir
let operator = ''; // Operator terakhir yang digunakan (tidak digunakan di logic ini, tapi saya biarkan)
let expression = ''; // Menyimpan ekspresi matematika lengkap (misal: "10*5+2")

function appendNumber(number) {
    // Menghapus '0' awal jika pengguna mulai mengetik angka
    if (currentNumber === '0' && number !== '.') {
        currentNumber = number;
    } 
    // Mencegah input berlebihan setelah hasil 'Error'
    else if (currentNumber === 'Error') {
        currentNumber = number;
    }
    else {
        currentNumber += number;
    }
    updateDisplay();
}

// ⭐ FUNGSI BARU UNTUK TITIK DESIMAL
function appendDecimal() {
    // Hanya tambahkan desimal jika currentNumber belum mengandung desimal
    if (!currentNumber.includes('.')) {
        // Jika currentNumber kosong atau 'Error', mulai dengan '0.'
        if (currentNumber === '' || currentNumber === 'Error') {
            currentNumber = '0.';
        } else {
            currentNumber += '.';
        }
        updateDisplay();
    }
}

function setOperator(op) {
    // Jika currentNumber masih kosong, abaikan operator
    if (currentNumber === '' && expression === '') return;

    // Jika operator ditekan setelah 'Error', reset dulu
    if (currentNumber === 'Error') {
        currentNumber = '0';
    }

    // Jika expression sudah ada dan currentNumber kosong (berarti operator beruntun), ganti operator lama
    if (expression.length > 0 && currentNumber === '') {
        // Hapus operator terakhir
        expression = expression.slice(0, -1) + op;
    }
    // Jika currentNumber memiliki nilai, tambahkan ke expression
    else if (currentNumber !== '') {
        expression += currentNumber + op;
    }

    operator = op;
    currentNumber = ''; // Clear currentNumber
    updateDisplay(); // Tampilan akan menunjukkan '0'
}

function calculateResult() {
    // Jika currentNumber masih memiliki nilai, tambahkan ke expression
    if (currentNumber !== '') {
        expression += currentNumber; 
    }

    // Hanya hitung jika expression tidak kosong
    if (expression === '') return;

    // Calculate the result from the expression
    try {
        // ⭐ Ganti simbol operator tampilan (× dan ÷) dengan simbol JavaScript (* dan /)
        const safeExpression = expression.replace(/×/g, '*').replace(/÷/g, '/');
        const result = eval(safeExpression);
        
        // Membatasi desimal dan menangani Infinity (misalnya, pembagian dengan 0)
        if (!isFinite(result)) {
            currentNumber = 'Error';
        } else {
            currentNumber = parseFloat(result.toFixed(10)).toString(); // Memperbaiki presisi desimal
        }
    } catch (error) {
        currentNumber = 'Error';
    }

    expression = ''; // Clear the expression after calculation
    updateDisplay(); // Update the display with the result
}

function clearDisplay() {
    currentNumber = ''; // Clear currentNumber
    operator = ''; // Clear the operator
    expression = ''; // Clear the expression
    updateDisplay(); // Update the display
}

function updateDisplay() {
    // Update the display input value. Jika currentNumber kosong, tampilkan '0'.
    document.getElementById('display').value = currentNumber || '0'; 
}

// Tambahkan ini agar tampilan awal selalu '0'
window.onload = updateDisplay;
</script>
<style>
    /*before*/
.card-body button {
    padding: 10px 20px;
    background-color: black;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    text-decoration:none;
}

.card-body button:hover {
    background-color: #333;
}

/*after*/
.card-body a {
    padding: 10px 20px;
    background-color: black;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    text-decoration:none;
}

.card-body a:hover {
    background-color: #333;
}
/* Body */
body {
    background-color: #121212;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: 'Roboto', sans-serif;
    position: relative;
}

/* Orange circle behind the calculator */
.background-circle {
    position: absolute;
    width: 400px;
    height: 400px;
    background-color: #ffcd00;
    border-radius: 50%;
    z-index: 1;
}

/* Calculator container */
.calculator {
    position: relative;
    background-color: #1f1f1f;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    width: 320px;
    text-align: center;
    color: white;
    z-index: 2; 
}

/* Input display section */
.display input[type="text"] {
    width: 100%;
    background-color: #333;
    border: none;
    border-radius: 8px;
    padding: 15px;
    font-size: 20px;
    color: #fff;
    text-align: right;
    margin-bottom: 10px;
    box-sizing: border-box;
}

/* Buttons section */
.buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

/* Buttons row */
.row {
    display: flex;
    justify-content: center; 
    gap: 15px; 
}

/* Button styling */
button {
    width: 65px;
    height: 65px;
    background-color: #444;
    border: none;
    border-radius: 50%;
    font-size: 22px;
    color: #fff;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s;
}

/* Specific styling for the zero button */
.zero {
    width: 140px; 
    border-radius: 50px; 
}

/* Operator button styling */
.operator {
    background-color: #ffcd00; 
    border-radius: 10px;
    width: 50px; 
    height: 50px; 
}

/* Button hover effect */
button:hover {
    background-color: #666;
    transform: scale(1.05);
}

/* Button active effect */
button:active {
    background-color: #888;
    transform: scale(1);
}


</style>


</html>